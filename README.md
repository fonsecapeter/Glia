# Glia
[Glia](glia-app.heroku.com) is an online support group for caregivers of dementia patients. It draws inspiration from Quora's tested question asking platform and is built on a rails-Postgres backend running on a thin web-server. The front end is built under the flux design pattern with React components, a React Router to handle the single-page app, and ajQuery ajax api facade.

## Features
### User Authentication
Sessions are kept secure throughout the stack. Immediately after submission, a user's password is digested to a hash. Post-sign in authentication is detached from this sensitive information through a session token generated by the secure-random library and is reset as needed. The front end only stores the current user in a local variable that is wrapped by the `SessionStore`.

### Rich Content
Content is written and displayed with formatting supported. The base html-generating editor comes from the quill package and is wrapped by the dropzone package for full image uploading support (with drag-and-drop). This integrates with Cloudinary to store the image data and generate a faster-loading image element.

![Rich Content][rich]

### Questions
Questions can be asked by any signed-in user and are organized by topic. There is a full front end flux architecture that minimizes network ajax calls to the server, holding data in a store. Questions can also be edited and deleted by the creating user.

### Answers
Any question can be answered by a signed in user. Questions can have any number of answers. Answers can be edited and deleted by the creating user. These resources are nested under questions in the flux loop to also gather only the necessary data as needed.

In practice, the `_questions` object will contain minimal information for each question in the main index page. Once a question is clicked on and the detail page opens, that question is overwritten with extra data including answers via the `_addQuestion` function) and is fetched in O(1) time by the `QuestionStore.find` method.

```javascript
  // question_store.js
  let _questions = {};

  function _addQuestion (question) {
    _questions[question.id] = question;
  }

  QuestionStore.find = function (questionId) {
    return _questions[questionId];
  };
```

### Comments
Questions and answers can be commented on. This is achieved through a polymorphic association, referred to as `Commentable`. Comments can be deleted by the creating user.

```ruby
  belongs_to :commentable, polymorphic: true
```

### Topics
Questions are tagged with topics, which users can create. Questions can also be displayed by topic. Each question has a set of related questions that are queried from the database by matching topics (sterilized to prevent injection attacks).

```sql
  SELECT DISTINCT
    questions.*
  FROM
    questions
    JOIN topic_taggings
      ON questions.id = topic_taggings.question_id
  WHERE
    (topic_taggings.topic_id = #{topic_ids})
    AND questions.id != #{self.id}
  LIMIT
    10
```

[rich]: docs/screenshots/rich.png "Rich Content"
